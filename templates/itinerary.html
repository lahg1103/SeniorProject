{% extends 'base.html' %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/itinerary.css') }}">
{% endblock %}

{% block body %}


{% if not results %}
<section>
    <h1>Itinerary Not Found</h1>
</section>
{% else %}
<section class="landing sidepage itinerary flex-column flex-center padding">
    <h1 class="hero serif center"> {{ results.city }} in {{ results.tripduration }} Days </h1>
    <h2 class="blurb sidepage center"> {{ results.promotionalblurb }} </h2>
</section>

{% if weather %}
<section class="weather-section padding-2x">
    <h2 class="subheader center margin">
<<<<<<< HEAD
        Weather Forecast for {{ weather.location or results.city }}
    </h2>
    {% if weather.source == "historical" %}
    <p class="weather-note center">
        *These condidtions are based on historical data because real-time forecasts are not available for the selected
        dates.*
    </p>
    {% endif %}
    <div class="weather-grid">
        {% for day in weather.days %}
        <article class="weather-day-card">
            <h3 class="serif">{{ day.date }}</h3>
=======
        Weather for {{ weather.location or results.city }}
    </h2>
    {% if weather.source == "historical" %}
    <p class="weather-note center">
        *These conditions are based on historical data because real-time forecasts are not available for the selected
        dates.*
    </p>
    {% endif %}

    <div class="weather-grid">
        {% for day in weather.days %}
        <article class="weather-day-card">
            <h3 class="serif">{{ day.date}}</h3>
>>>>>>> added weather data to itinerary
            <p>
                High: {{ day.temp_max }}°C | Low: {{ day.temp_min }}°C
            </p>
            {% if day.precipitation is not none %}
<<<<<<< HEAD
            <p>
                Precipitation: {{ day.precipitation }} mm
            </p>
            {% endif %}
            {% if day.description %}
            <p> {{ day.description }}</p>
=======
            <p> Precipitation: {{ day.precipitation }} mm </p>
            {% endif %}
            {% if day.description %}
            <p> {{ day.description }} </p>
>>>>>>> added weather data to itinerary
            {% endif %}
        </article>
        {% endfor %}
    </div>

    <p class="weather-disclaimer small center">
        Weather data is based on publicly available forecasts or historical averages. This feature does not predict
        extreme weather events, natural disasters, or sudden climate anomalies. Users should consult official sources
<<<<<<< HEAD
        for real-time alers and safety information.
=======
        for real-time alerts and safety information
>>>>>>> added weather data to itinerary
    </p>
</section>
{% endif %}

<section class="itinerary-wrapper relative flex-column padding-2x flex-center">
    <div class="navigation-days relative">
        <ul class="itinerary-top-navigation uppercase padding-block gap width-100 relative">
<<<<<<< HEAD
            {% for i in range(0, results["tripduration"], +1) %}
            <a href="#day{{ i + 1 }}">
                <li class="{{ i + 1 }}">
                    Day {{ i + 1 }}
=======
            {% for day in results.itineraryperday %}
            <a href="#day{{ loop.index }}">
                <li class="{{ loop.index }}">
                    Day {{ loop.index }}
>>>>>>> added weather data to itinerary
                </li>
            </a>
            {% endfor %}
        </ul>
    </div>
    {% for day in results["itineraryperday"] %}

    <section class="day-card margin-block center" id="day{{ loop.index }}">
        <h3 class="itinerary-heading serif"> Day {{ loop.index }} </h3>
        <p> {{ day["daysummary"] }} </p>

        <div class="day-img relative center justify-self margin-inline">
            {% if results['images'] %}
            <img src="{{ results['images'][loop.index] }}" alt="">
            {% endif %}
        </div>

        <h3 class="subheader">Lodging: </h3>
        <p>{{ day["lodging"]["name"] }} &mdash; {{ day["lodging"]["address"] }} | cost: {{ day["lodging"]["cost"] }}
        </p>
        <div class="google gap relative flex flex-center">
            <div class="map relative height-100" data-location="{{ day['lodging']['name'] }}"
                data-address="{{ day['lodging']['address'] }}">
                <iframe src="" frameborder="0"></iframe>
            </div>
            <div class="img relative height-100"></div>
        </div>

        {% for activity in day["timeblocks"]["morning"] %}
        <h3 class="subheader">{{ activity["time"] }}</h3>
        <p>{{ activity["name"] }} &mdash; {{ activity["address"] }} | cost: {{ activity["cost"] }} </p>
        <p>{{ activity["summary"] }}</p>
        <p><strong>Breakfast: </strong> {{ day["food"]["breakfast"]["restaurant"] }} &mdash; {{
            day["food"]["breakfast"]["address"] }} | cost: {{ day["food"]["lunch"]["cost"]}}</p>
        <div class="google gap relative flex flex-center">
            <div class="map relative height-100" data-location="{{ day['food']['breakfast']['restaurant'] }}"
                data-address="{{ day['food']['breakfast']['address'] }}">
                <iframe src="" frameborder="0"></iframe>
            </div>
            <div class="img relative height-100"></div>
        </div>
        {% endfor %}

        {% for activity in day["timeblocks"]["afternoon"] %}
        <h3 class="subheader">{{ activity["time"] }}</h3>
        <p>{{ activity["name"] }} &mdash; {{ activity["address"] }} | cost: {{ activity["cost"] }} </p>
        <p>{{ activity["summary"] }}</p>
        <p><strong>Lunch: </strong> {{ day["food"]["lunch"]["restaurant"] }} &mdash; {{ day["food"]["lunch"]["address"]
            }} | cost: {{ day["food"]["lunch"]["cost"]}}</p>
        <div class="google gap relative flex flex-center">
            <div class="map relative height-100" data-location="{{ day['food']['lunch']['restaurant'] }}"
                data-address="{{ day['food']['lunch']['address'] }}">
                <iframe src="" frameborder="0"></iframe>
            </div>
            <div class="img relative height-100"></div>
        </div>
        {% endfor %}

        {% for activity in day["timeblocks"]["evening"] %}
        <h3 class="subheader">{{ activity["time"] }}</h3>
        <p>{{ activity["name"] }} &mdash; {{ activity["address"] }} | cost: {{ activity["cost"] }} </p>
        <p>{{ activity["summary"] }}</p>
        <p><strong>Dinner: </strong> {{ day["food"]["dinner"]["restaurant"] }} &mdash; {{
            day["food"]["dinner"]["address"] }} | cost: {{ day["food"]["lunch"]["cost"]}}</p>
        <div class="google gap relative flex flex-center">
            <div class="map relative height-100" data-location="{{ day['food']['dinner']['restaurant'] }}"
                data-address="{{ day['food']['dinner']['address'] }}">
                <iframe src="" frameborder="0"></iframe>
            </div>
            <div class="img relative height-100"></div>
        </div>
        {% endfor %}

    </section>
    {% endfor %}
</section>
{% endif %}
{% if results["images"] %}
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const itinerary = document.querySelector('.itinerary');
        const imgURL = '{{ results["images"][0] }}';
        itinerary.style.setProperty('--bg-img', `url(${imgURL})`);
    })
</script>
{% endif %}
<script>const apiKey = '{{ googleKey }}';</script>
<script src="{{ url_for('static', filename='javascript/itinerary.js') }}"></script>

{% endblock %}